<!doctype html>
<html lang="en">
  <head>
    <title>EchoPlay Experiments!</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="css/echoplay.css"/>
  </head>
  <body>
    <script src="js/jquery/jquery.min.js"></script>
    <script src="js/pep/pep.min.js"></script>

    <div id="main">
      <div id="header">
        <div id="code"><canvas id="qrcode"></canvas></div>
        <div id="jam">
          <p>join the jam @</p>
          <p><strong id="url"></strong></p>
        </div>
        <div id="app-title">
          <h1>echo<strong>play</strong></h1>
        </div>
      </div>
      <div id="interface">
      </div>
    </div>

    <script>
    var Tone
    function isElectron() {
      return (typeof process !== "undefined") && process.versions && (process.versions.electron !== undefined)
    }

    if (isElectron()){
      window.$ = window.jQuery = require('jquery');
    }

    $(window).on("load", function() {
      let scripts = [
        'js/mobile.js',
        'js/note.js',
        'js/instrument.js',
        'js/interface.js',
        'js/settings.js',
        'js/shortcuts.js',
        'js/midi.js'
      ]
      $.getScript("js/mousetrap/mousetrap.min.js")
       .then(() => { return $.getScript("js/mousetrap/plugins/bind-dictionary/mousetrap-bind-dictionary.min.js") })
       .then(() => { return $.getScript("socket.io/socket.io.js") })
       .then(() => { return $.getScript("js/qrcode/qrcode.min.js") })
       .then(() => {
         if (isElectron() == true){
           Tone = require("tone");
         } else {
           return $.getScript("js/tone/Tone.min.js")
         }
        })
       .then(() => { return $.getScript("js/vendor/startaudiocontext.js") })
       .then(() => { scripts.forEach(script => {return $.getScript(script)}) })
       .then(() => {
         $("h1").click(function(){ toggleFullScreen() })
         $("#qrcode").click(function(){ echoplay.toggleSettings() })
       })
    })
    </script>

  </body>
</html>
